(window.webpackJsonp=window.webpackJsonp||[]).push([[64],{224:function(e,t,s){"use strict";s.d(t,"a",(function(){return r}));class r{constructor(e,t,s=new Map,i=r.DEFAULT_CONNECTION_TIMEOUT,n=r.DEFAULT_PENDING_TIMEOUT){this._url=e,this._parameters=t,this._headers=s,this._connectionTimeout=i,this._pendingTimeout=n}getConnectionTimeout(){return this._connectionTimeout}getPendingTimeout(){return this._pendingTimeout}getUrl(){return this._url}getParameters(){return this._parameters}getHeaders(){return this._headers}}r.DEFAULT_CONNECTION_TIMEOUT=5e3,r.DEFAULT_PENDING_TIMEOUT=15e3},530:function(e,t,s){e.exports=s(548)},548:function(e,t,s){"use strict";s.r(t);var r=s(395);s(222);class i{constructor(e){this._id=e}getId(){return this._id}}var n,a,o,h=s(119);class l{constructor(e){this._key="lsnp_channels",this._storage=e,this._channels=new h.MemoryEntitySet({serialize:e=>e.getId()})}init(e){const t=this;return new Promise(s=>{t._storage.get(t._key).then(r=>{if(r)for(const e of r)t._channels.add(new i(e));else e&&e.getAll().forEach(e=>{t._channels.add(e)});s(t._channels)})})}getChannels(){return this._channels.clone()}setChannels(e){return new Promise((t,s)=>{this._channels.clear();const r=[];for(const t of e)this._channels.add(t),r.push(t.getId());this._storage.set(this._key,r).then(()=>t()).catch(e=>s())})}}class c{constructor(e,t){this._id=`${e}_${t}`}getId(){return this._id}}class _ extends l{constructor(){super(...arguments),this._key="lsnp_channels_disabled"}}class u{constructor(e,t){this._id=`lsid_${e}_${t}`}getId(){return this._id}}class g{constructor(e,t){const s=t.split("_")[2];this._id=e+"_"+s}getId(){return this._id}}class p{constructor(e,t){const s=t.split("_")[1];this._id=e+"_TEAM_"+s}getId(){return this._id}}class d{constructor(e){this._key="lsnp_options",this._storage=e,this._options=new h.MemoryEntitySet({serialize:e=>e.getValue()})}init(e){const t=this;return new Promise(s=>{this._storage.get(this._key).then(r=>{if(r)for(const e of r)t._options.add(new m(e));else e&&e.getAll().forEach(e=>{t._options.add(e)});s(t._options)})})}getOptions(){return this._options.clone()}setOptions(e){return new Promise((t,s)=>{this._options.clear();const r=[];for(const t of e)this._options.add(t),r.push(t.getValue());this._storage.set(this._key,r).then(()=>t()).catch(e=>s())})}}class m{constructor(e){this._id=e}getValue(){return this._id}}class w{constructor(){this._options=new h.MemoryEntitySet({serialize:e=>e.getValue()})}init(e){const t=this;return new Promise(s=>{e&&e.getAll().forEach(e=>{t._options.add(e)}),s(t._options)})}getOptions(){return this._options.clone()}setOptions(e){return new Promise((t,s)=>{this._options.clear();const r=[];for(const t of e)this._options.add(t),r.push(t.getValue())})}}class k{constructor(e,t,s,r){this._id=e,this._email=t,this._hash=s,this._namespace=r}getId(){return this._id}getEmail(){return this._email}getHash(){return this._hash}getNamespace(){return this._namespace}}class f{constructor(e){this.STORAGE_KEY="lsnp_credentials_3",this._storage=e,this._credentials=new h.MemoryEntitySet({serialize:e=>e.getHash()}),this._loadCredentials()}getCredentials(){return this._credentials.clone()}setCredentials(e){return new Promise((t,s)=>{this._credentials.clear(),this._credentials.add(e),this._storage.set(this.STORAGE_KEY,e).then(()=>t()).catch(e=>s())})}_loadCredentials(){const e=this;this._storage.get(this.STORAGE_KEY).then(t=>{t&&e._credentials.add(new k(t._id,t._email,t._hash,t._namespace))})}}!function(e){e.NOT_INITIALIZED="NOT_INITIALIZED",e.INITIALIZED="PERMISSION_GRANTED",e.PERMISSION_DENIED="PERMISSION_DENIED",e.UNSUPPORTED="UNSUPPORTED"}(n||(n={}));class b{constructor(e,t,s,r,i,n){this._stepRunCache=new Map,this._requestNotificationPermission=e,this._serviceWorkerSupportCheck=t,this._subscribeServiceWorker=s,this._messagingServiceWorker=r,this._registerTokenListener=i,this._logger=n}run(){return this._rejectWith(this._serviceWorkerSupportCheck.make(),n.UNSUPPORTED).then(()=>this._rejectWith(this._requestNotificationPermission.make(),n.PERMISSION_DENIED)).then(()=>this._rejectWith(this._subscribeServiceWorker.make(),n.UNSUPPORTED)).then(e=>this._rejectWith(this._runWhenNotSuccessfulAlready(this._messagingServiceWorker,e),n.UNSUPPORTED)).then(()=>this._rejectWith(this._registerTokenListener.make(),n.UNSUPPORTED)).then(()=>Promise.resolve(n.INITIALIZED))}_runWhenNotSuccessfulAlready(e,t){return this._stepRunCache.has(e)?Promise.resolve(this._stepRunCache.get(e)):e.make(t).then(t=>(this._stepRunCache.set(e,t),Promise.resolve(t)))}_rejectWith(e,t){return e.catch(e=>(this._logger(e),Promise.reject(t)))}}class C{constructor(e,t){this._delegate=e,this._onResult=t}make(e){return this._delegate.make(e).then(e=>(this._onResult(e),Promise.resolve(e)))}}class S{constructor(e){this.messaging=e}make(){return this.messaging.requestPermission()}}class P{constructor(e,t){this.navigator=e,this.window=t}make(){return"serviceWorker"in this.navigator&&"PushManager"in this.window?Promise.resolve():Promise.reject("Push messages not supported")}}class A{constructor(e,t){this.navigator=e,this.pushServiceWorkerLocation=t}make(){return this.navigator.serviceWorker.register(this.pushServiceWorkerLocation).then(e=>Promise.resolve(e)).catch(e=>Promise.reject("SW registration failed: "+JSON.stringify(e)))}}class T{constructor(e){this.messaging=e}make(e){return this.messaging.useServiceWorker(e),Promise.resolve()}}class v{constructor(e,t){this.messaging=e,this.tokenListener=t}make(){return this.messaging.onTokenRefresh(()=>{this.messaging.getToken().then(e=>{e&&this.tokenListener(e)}).catch(e=>{})}),this.messaging.getToken().then(e=>{e&&this.tokenListener(e)})}}!function(e){e.DEFAULT="default",e.DENIED="denied",e.GRANTED="granted"}(a||(a={}));class y{constructor(e){this._windowPermissionProvider=e}getPermissions(){let e=a.DEFAULT;switch(this._windowPermissionProvider()){case"denied":e=a.DENIED;break;case"granted":e=a.GRANTED}return Promise.resolve(e)}}!function(e){e.HTML_TEMPLATE='<div id="notifications-alert">\n\t<div class="alert alert--notifications">##MESSAGE##</div>\n</div>'}(o||(o={}));var E=function(e,t,s,r){return new(s||(s=Promise))((function(i,n){function a(e){try{h(r.next(e))}catch(e){n(e)}}function o(e){try{h(r.throw(e))}catch(e){n(e)}}function h(e){var t;e.done?i(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,o)}h((r=r.apply(e,t||[])).next())}))};class I{constructor(e,t){this._hidden=!1,this._subscribeCallback=()=>{},this._pendingCallback=()=>{},this._deniedCallback=()=>{},this._windowPermissionProvider=e,this._alertWrapper=t}run(){return E(this,void 0,void 0,(function*(){switch(yield this.getStatus()){case a.DEFAULT:this._alertNotificationsDefault();break;case a.GRANTED:this._alertNotificationGranted();break;case a.DENIED:this._alertNotificationDenied()}}))}getStatus(){return E(this,void 0,void 0,(function*(){return new y(this._windowPermissionProvider).getPermissions()}))}setTranslations(e){return this._utilTrans=e,this}setStorage(e){return this._storage=e,this}setSubscribeCallback(e){return this._subscribeCallback=e,this}setPendingCallback(e){return this._pendingCallback=e,this}setDeniedCallback(e){return this._deniedCallback=e,this}showAlert(){this._alertWrapper&&!this._hidden&&(this._alertWrapper.style.display="block")}hideAlert(){this._hidden=!0,this._alertWrapper&&(this._alertWrapper.style.display="none")}_alertNotificationsDefault(){const e=!!this._storage.getSession("LS_notifications_dismissed");if(this._alertWrapper&&!e){let e=o.HTML_TEMPLATE;const t=this._utilTrans.translate("TRANS_NOTIFICATIONS_ARE_OFF"),s=this._utilTrans.translate("TRANS_NOTIFICATIONS_PROMPT"),r=this._utilTrans.translate("TRANS_NOTIFICATIONS_SET");e=e.replace("##MESSAGE##",`\n\t\t\t\t\t<div class="alert__icon"></div>\n\t\t\t\t\t<div class="alert__close" onclick="this.parentElement.style.display = 'none'"></div>\n\t\t\t\t\t<div class="alert__text"><strong>${t}.</strong> ${s}</div>\n\t\t\t\t\t<div id="notifications-alert-button" class="alert__button">${r}</div>`),this._alertWrapper.innerHTML=e;const i=document.getElementById("notifications-alert-button");i&&(i.onclick=this._subscribeCallback),this._pendingCallback()}}_alertNotificationGranted(){this._alertWrapper&&this.hideAlert(),this._subscribeCallback()}_alertNotificationDenied(){const e=!!this._storage.getSession("LS_notifications_dismissed");if(this._alertWrapper&&!e){let e=o.HTML_TEMPLATE;const t=this._utilTrans.translate("TRANS_NOTIFICATIONS_BLOCKED_BY_BROWSER"),s=this._utilTrans.translate("TRANS_NOTIFICATIONS_BLOCKED_PROMPT");e=e.replace("##MESSAGE##",`\n\t\t\t\t\t<div class="alert__icon"></div>\n\t\t\t\t\t<div class="alert__close" onclick="this.parentElement.style.display = 'none'"></div>\n\t\t\t\t\t<div class="alert__text"><strong>${t}.</strong> ${s}</div>`),this._alertWrapper.innerHTML=e,this.showAlert()}this._deniedCallback()}}var N=s(154);var O=s(224),D=s(249);class q{makeRequest(e){return new Promise((t,s)=>{const r={};e.getHeaders().forEach((e,t)=>{r[t]=e});const i=e.getParameters();i.appVersion="1.0",i.appId="com.flashscore",D.post(e.getUrl()).type("form").send(i).timeout({response:e.getPendingTimeout(),deadline:e.getConnectionTimeout()}).set(r).then(e=>{const s=new Map;for(const t in e.header)s.set(t,e.header[t]);t(new N.ResponseImpl(e.text,e.status,s))},e=>s(e.message))})}}class L{constructor(e){this._pathPrefix=e}makeRequest(e){const t={};for(const s in e.params)t[s]=e.params[s];return new O.a(this._pathPrefix+e.path+"/",t)}}class R{constructor(e,t,s){this._requestProvider=e,this._apiResponseChecker=t,this._requestor=s}makeCall(e){return this._requestor.makeRequest(this._requestProvider.makeFor(e)).then(e=>this._apiResponseChecker.isOk(e)?Promise.resolve():Promise.reject("Invalid server response: '"+JSON.stringify(e)+"'"))}}class M{isOk(e){return"ok"==e.getContent()}}class F{throwOnInvalidParams(e){if(!Array.isArray(e))throw new Error("Params should be array");if(!e.length)throw new Error("Params should be non array");e.forEach(e=>null!=e.getId())}}class x{constructor(e,t){this._apiCallDelegate=e,this._paramsValidator=t}makeCall(e){try{this._paramsValidator.throwOnInvalidParams(e)}catch(t){return Promise.reject("Invalid params '"+JSON.stringify(e)+"'. "+t.message)}return this._apiCallDelegate.makeCall(e)}}class W{constructor(e,t,s){this._requestor=e,this._requestProvider=new U(t,s),this._responseChecker=new M}make(){return new x(new R(this._requestProvider,this._responseChecker,this._requestor),new F)}}class U{constructor(e,t){this._tokenPart=e,this._requestFormatter=t}makeFor(e){return this._requestFormatter.makeRequest({path:"subscribe",params:{channels:JSON.stringify(e.map(e=>e.getId())),token:this._tokenPart()}})}}class G{constructor(e,t,s){this._requestor=e,this._requestProvider=new j(t,s),this._responseChecker=new M}make(){return new x(new R(this._requestProvider,this._responseChecker,this._requestor),new F)}}class j{constructor(e,t){this._tokenPart=e,this._requestFormatter=t}makeFor(e){return this._requestFormatter.makeRequest({path:"unsubscribe",params:{channels:JSON.stringify(e.map(e=>e.getId())),token:this._tokenPart()}})}}class z{throwOnInvalidParams(e){if(!Array.isArray(e))throw new Error("Params should be array");if(!e.length)throw new Error("Params should be non array");e.forEach(e=>null!=e.getValue())}}class J{constructor(e,t,s){this._requestor=e,this._requestProvider=new B(t,s),this._responseChecker=new M}make(){return new x(new R(this._requestProvider,this._responseChecker,this._requestor),new V)}}class V{constructor(){this._channelsValidator=new F,this._settingsValidator=new z}throwOnInvalidParams(e){if(!Array.isArray(e))throw new Error("Params should be array [Channel[], Option[]]");this._channelsValidator.throwOnInvalidParams(e[0]),this._settingsValidator.throwOnInvalidParams(e[1])}}class B{constructor(e,t){this._tokenPart=e,this._requestFormatter=t}makeFor(e){return this._requestFormatter.makeRequest({path:"subscribe-all",params:{channels:JSON.stringify(e[0].map(e=>e.getId())),settings:JSON.stringify(e[1].map(e=>e.getValue())),token:this._tokenPart()}})}}class H{constructor(e,t,s){this._requestor=e,this._requestProvider=new K(t,s),this._responseChecker=new M}make(){return new x(new R(this._requestProvider,this._responseChecker,this._requestor),new z)}}class K{constructor(e,t){this._tokenPart=e,this._requestFormatter=t}makeFor(e){return this._requestFormatter.makeRequest({path:"settings",params:{settings:JSON.stringify(e.map(e=>e.getValue())),token:this._tokenPart()}})}}class ${constructor(e,t,s){this._requestor=e,this._requestProvider=new Y(t,s),this._responseChecker=new M}make(){return new x(new R(this._requestProvider,this._responseChecker,this._requestor),new z)}}class Y{constructor(e,t){this._tokenPart=e,this._requestFormatter=t}makeFor(e){return this._requestFormatter.makeRequest({path:"subscribe-token",params:{settings:JSON.stringify(e.map(e=>e.getValue())),token:this._tokenPart()}})}}class Z{constructor(e,t,s){this._requestor=e,this._requestProvider=new Q(t,s),this._responseChecker=new M}make(){return new x(new R(this._requestProvider,this._responseChecker,this._requestor),new F)}}class Q{constructor(e,t){this._tokenPart=e,this._requestFormatter=t}makeFor(e){return this._requestFormatter.makeRequest({path:"subscribe-disable",params:{channelsDisabled:JSON.stringify(e.map(e=>e.getId())),token:this._tokenPart()}})}}class X{constructor(e,t,s){this._requestor=e,this._requestProvider=new ee(t,s),this._responseChecker=new M}make(){return new x(new R(this._requestProvider,this._responseChecker,this._requestor),new F)}}class ee{constructor(e,t){this._tokenPart=e,this._requestFormatter=t}makeFor(e){return this._requestFormatter.makeRequest({path:"unsubscribe-disable",params:{channelsDisabled:JSON.stringify(e.map(e=>e.getId())),token:this._tokenPart()}})}}class te{constructor(e,t,s,r,i,n,a){this._addChannelsApiCall=e,this._removeChannelsApiCall=t,this._updateSettingsApiCall=s,this._unSubscribeAllApiCall=r,this._subscribeAllApiCall=i,this._unSubscribeDisableApiCall=n,this._subscribeDisableApiCall=a}addChannels(e){return this._addChannelsApiCall.makeCall(e)}removeChannels(e){return this._removeChannelsApiCall.makeCall(e)}updateSettings(e){return this._updateSettingsApiCall.makeCall(e)}subscribeAll(e,t){return this._subscribeAllApiCall.makeCall([e,t])}unSubscribeAll(e){return this._unSubscribeAllApiCall.makeCall(e)}subscribeDisable(e){return this._subscribeDisableApiCall.makeCall(e)}unSubscribeDisable(e){return this._unSubscribeDisableApiCall.makeCall(e)}}var se=s(309);class re{constructor(e){this._delegateApi=e,this._promiseSerializer=new se.PromiseSerialExecutor({nextPromise:e=>e()})}addChannels(e){return this._promiseSerializer.next(()=>this._delegateApi.addChannels(e))}removeChannels(e){return this._promiseSerializer.next(()=>this._delegateApi.removeChannels(e))}updateSettings(e){return this._promiseSerializer.next(()=>this._delegateApi.updateSettings(e))}subscribeAll(e,t){return this._promiseSerializer.next(()=>this._delegateApi.subscribeAll(e,t))}unSubscribeAll(e){return this._promiseSerializer.next(()=>this._delegateApi.unSubscribeAll(e))}subscribeDisable(e){return this._promiseSerializer.next(()=>this._delegateApi.subscribeDisable(e))}unSubscribeDisable(e){return this._promiseSerializer.next(()=>this._delegateApi.unSubscribeDisable(e))}}class ie{constructor(){this._platformPrefix=""}setRequestor(e){return this._requestor=e,this}setPlatformPrefix(e){return this._platformPrefix=e,this}setUserTokenGetter(e){return this._userTokenGetter=e,this}build(){const e=new W(this._requestor,this._userTokenGetter,new L(this._platformPrefix)).make(),t=new G(this._requestor,this._userTokenGetter,new L(this._platformPrefix)).make(),s=new H(this._requestor,this._userTokenGetter,new L(this._platformPrefix)).make(),r=new $(this._requestor,this._userTokenGetter,new L(this._platformPrefix)).make(),i=new J(this._requestor,this._userTokenGetter,new L(this._platformPrefix)).make(),n=new Z(this._requestor,this._userTokenGetter,new L(this._platformPrefix)).make(),a=new X(this._requestor,this._userTokenGetter,new L(this._platformPrefix)).make();return new re(new te(e,t,s,r,i,a,n))}}class ne{constructor(e,t,s,r){this.doInit=!0,this.subscribedEmpty=!1,this.pushApi=e,this.subscriptionCollectionFactory=t,this.disabledSubscriptionCollectionFactory=s,this.settingsCollectionFactory=r,this.promiseSerializer=new se.PromiseSerialExecutor({nextPromise:e=>e()})}channelsChanged(e,t,s){return this.promiseSerializer.next(()=>{if(0==e.length&&this.subscribedEmpty)return Promise.resolve();if(0==e.length)return this.doInit=!0,this.pushApi.unSubscribeAll(s).then(()=>{this.subscribedEmpty=!0});if(this.subscribedEmpty=!1,this.doInit)return Promise.all([this.pushApi.subscribeAll(e,s),t.length?this.pushApi.subscribeDisable(t):void 0]).then(()=>(this.doInit=!1,Promise.resolve()));const r=[],i=[],n=[],a=[],o=this.subscriptionCollectionFactory(),h=this.disabledSubscriptionCollectionFactory();return e.forEach(e=>{o.has(e)||r.push(e)}),t.forEach(e=>{h.has(e)||n.push(e)}),o.getAll().forEach(t=>{let s=!1;for(const r of e)if(JSON.stringify(r)==JSON.stringify(t)){s=!0;break}s||i.push(t)}),h.getAll().forEach(e=>{let s=!1;for(const r of t)if(JSON.stringify(r)==JSON.stringify(e)){s=!0;break}s||a.push(e)}),Promise.all([r.length?this.pushApi.addChannels(r):void 0,i.length?this.pushApi.removeChannels(i):void 0,n.length?this.pushApi.subscribeDisable(n):void 0,a.length?this.pushApi.unSubscribeDisable(a):void 0,this.handleSettings(s)]).then(()=>Promise.resolve())})}handleSettings(e){const t=this.settingsCollectionFactory();let s=!1;for(const r of e)if(!t.has(r)){s=!0;break}return s||t.getAll().forEach(t=>{let r=!1;for(const s of e)if(JSON.stringify(s)==JSON.stringify(t)){r=!0;break}r||(s=!0)}),s?this.pushApi.updateSettings(e):Promise.resolve()}}const ae=[new m("sport_1;3"),new m("sport_1;4"),new m("sport_1;41"),new m("sport_2;3"),new m("sport_3;3"),new m("sport_4;3"),new m("sport_4;4"),new m("sport_4;41"),new m("sport_5;3"),new m("sport_6;3"),new m("sport_7;3"),new m("sport_8;3"),new m("sport_9;3"),new m("sport_10;3"),new m("sport_11;3"),new m("sport_12;3"),new m("sport_13;3"),new m("sport_14;3"),new m("sport_15;3"),new m("sport_16;3"),new m("sport_17;3"),new m("sport_18;3"),new m("sport_19;3"),new m("sport_21;3"),new m("sport_22;3"),new m("sport_24;3"),new m("sport_25;3"),new m("sport_26;3"),new m("sport_28;3"),new m("sport_29;3"),new m("sport_30;3"),new m("sport_34;63"),new m("sport_36;3"),new m("sport_23;63"),new m("sport_23;103"),new m("sport_23;62"),new m("sport_23;60"),new m("sport_23;101"),new m("sport_23;61"),new m("sport_42;3"),new m("sport_31;63"),new m("sport_31;103"),new m("sport_31;62"),new m("sport_32;63"),new m("sport_32;103"),new m("sport_32;62"),new m("sport_33;63"),new m("sport_33;103"),new m("sport_33;62"),new m("sport_37;60"),new m("sport_37;61"),new m("sport_37;101"),new m("sport_37;62"),new m("sport_37;63"),new m("sport_37;103"),new m("sport_38;60"),new m("sport_38;61"),new m("sport_38;101"),new m("sport_38;62"),new m("sport_38;63"),new m("sport_38;103"),new m("sport_39;60"),new m("sport_39;61"),new m("sport_39;101"),new m("sport_39;62"),new m("sport_39;63"),new m("sport_39;103"),new m("sport_40;60"),new m("sport_40;61"),new m("sport_40;101"),new m("sport_40;62"),new m("sport_40;63"),new m("sport_40;103"),new m("sport_41;60"),new m("sport_41;61"),new m("sport_41;101"),new m("sport_41;62"),new m("sport_41;63"),new m("sport_41;103")];function oe(){const e=new h.MemoryEntitySet({serialize:e=>e.getValue()});for(const t of ae)e.add(t);return e}class he{constructor(e,t,s,r){this._lsnpPath=e,this._language=t,this._token=s||"",this._enabled=void 0===r||r}setToken(e){return this._token=e||"",this}getToken(){return this._token}getLsnpPath(){return this._lsnpPath}getLanguage(){return this._language}isEnabled(){return this._enabled}}class le{constructor(e){this.STORAGE_KEY="lsnp_token",this._storage=e,this._tokens=new h.MemoryEntitySet({serialize:e=>e.getToken()})}init(e){const t=this;return new Promise(s=>{this._storage.get(this.STORAGE_KEY).then(r=>{r?t._tokens.add(new he(r._lsnpPath,r._language,r._token,r._enabled)):e&&e.getAll().forEach(e=>{t._tokens.add(e)}),s(t._tokens)})})}getToken(){const e=this._tokens.clone().getAll();return e.length?e[0]:new he("","")}setToken(e){return new Promise((t,s)=>{this._tokens.clear(),this._tokens.add(e),this._storage.set(this.STORAGE_KEY,e).then(()=>t()).catch(e=>s())})}}class ce{constructor(e,t,s,r,i,n,a,o,h,l,c,_){this._enabled=!1,this._registrationListener=()=>null,this._messaging=e,this._language=t,this._platformPrefix=s,this._window=r,this._navigator=i,this._serviceWorkerLocation=n,this._credentials=c,this._logger=_,this._tokenStorage=a,a.init().then(()=>{this.synchronize()}),o.init().then(()=>{this._currentChannels=o,this.synchronize()}),h.init().then(()=>{this._currentDisabledChannels=h,this._disabledChannels=[],this._currentDisabledChannels.getChannels().getAll().forEach(e=>{this._disabledChannels.push(e)}),this.synchronize()}),l.init(oe()).then(e=>{this._currentSettings=l;const t=new w;t.init(e).then(()=>{this._settings=t,this.synchronize()})})}enable(){this._enabled=!0}setPermissionProvider(e){return this._permissionProvider=e,this}setAlertWrapper(e){return this._alertWrapper=e,this}_getToken(){return this._tokenStorage.getToken()}setUserToken(e){const t=!!this.getUserToken()||this.getUserToken()!=e,s=!this.getUserToken()||this.isUserTokenEnabled();return t&&(this._tokenStorage.setToken(new he(this._platformPrefix,this._language,e,s)),this.synchronize()),this}getUserToken(){return this._getToken().getToken()}isUserTokenEnabled(){return this._getToken().isEnabled()}setUserTokenEnabled(e){this._tokenStorage.setToken(new he(this._platformPrefix,this._language,this.getUserToken(),e)),this.synchronize()}setMyGames(e){return this._myGames=e,this}setMyTeams(e){return this._myTeams=e,this}setLoginClient(e){return this._loginClient=e,this}_getApi(){return this._pushApi||(this._pushApi=(new ie).setPlatformPrefix(this._platformPrefix).setRequestor(new q).setUserTokenGetter(()=>this.getUserToken()).build()),this._pushApi}_getSynchronizer(){return this._synchonizer||(this._synchonizer=new ne(this._getApi(),()=>this.getCurrentChannels(),()=>this.getCurrentDisabledChannels(),()=>this.getCurrentSettings())),this._synchonizer}getStatusAlert(){return this._notificationStatusAlert||(this._notificationStatusAlert=new I(this._permissionProvider,this._alertWrapper)),this._notificationStatusAlert}getNotificationInit(){const e=new S(this._messaging),t=new P(this._navigator,this._window),s=new C(new A(this._navigator,this._serviceWorkerLocation),this._registrationListener),r=new T(this._messaging),i=new v(this._messaging,e=>this.setUserToken(e));return new b(e,t,s,r,i,this._logger)}getCurrentChannels(){return this._currentChannels.getChannels()}getCurrentDisabledChannels(){return this._currentDisabledChannels.getChannels()}getCurrentSettings(){const e=this._currentSettings.getOptions();if(e.isEmpty())for(const t of ae)e.add(t);return e}addSettingOption(e){const t=this._getSettingsOptions();return t.push(new m(e)),this._settings.setOptions(t)}removeSettingOption(e){const t=this._getSettingsOptions().filter(t=>t.getValue()!=e);return this._settings.setOptions(t)}muteChannel(e){const t=this._getDisabledChannels();return t.push(new c(this._language,e)),this._disabledChannels=t,this.synchronize()}unMuteChannel(e){const t=new c(this._language,e).getId(),s=this._getDisabledChannels().filter(e=>e.getId()!=t);return this._disabledChannels=s,this.synchronize()}synchronize(){return new Promise((e,t)=>{if(!(this._enabled&&this.getUserToken()&&this._currentSettings&&this._currentChannels&&this._currentDisabledChannels))return void e(!1);const s=[];this.isUserTokenEnabled()&&(s.push(...this._getLoginClientChannels()),s.push(...this._getMyGamesChannels()),s.push(...this._getMyTeamsChannels()));const r=this._getDisabledChannels(),i=[];i.push(...this._getSettingsOptions()),this._getSynchronizer().channelsChanged(s,r,i).then(()=>{this._currentChannels.setChannels(s),this._currentDisabledChannels.setChannels(r),this._currentSettings.setOptions(i),e(!0)}).catch(()=>{e(!1)})})}_getDisabledChannels(){return this._disabledChannels}_getSettingsOptions(){const e=[];let t;return t=this._settings?this._settings.getOptions():oe(),t.getAll().forEach(t=>{e.push(t)}),e}_getMyGamesChannels(){const e=[];if(this._myGames){const t=this._myGames.getFromStorage();if(t){const s=Object.keys(t);for(const t of s)e.push(new g(this._language,t))}}return e}_getMyTeamsChannels(){const e=[];if(this._myTeams){const t=this._myTeams.getParticipantKeysFromLsid();if(t)for(const s of t)e.push(new p(this._language,s))}return e}_getLoginClientChannels(){const e=[];if(this._loginClient&&this._loginClient.loggedIn()){const t=this._loginClient.id(),s=this._loginClient.email(),r=this._loginClient.hash(),i=this._loginClient.namespace();t&&s&&i&&r&&(e.push(new u(s,i)),this._credentials.setCredentials(new k(t,s,r,i)))}return e}}class _e{constructor(){this._window=window,this._navigator=navigator}setFirebaseConfiguration(e){const t=r.initializeApp(e);return this._messaging=t.messaging(),this}setLanguage(e){return this._language=e,this}setPlatformPrefix(e){return this._platformPrefix=e,this}setBrowserDepenedency(e,t){return this._window=e,this._navigator=t,this}setServiceWorkerLocation(e){return this._serviceWorkerLocation=e,this}setTokenStorage(e){return this._token=new le(e),this}setSettingsStorage(e){return this._currentChannels=new l(e),this._currentDisabledChannels=new _(e),this._currentOptions=new d(e),this}setCredentialsStorage(e){return this._credentials=new f(e),this}setLogger(e){return this._logger=e,this}build(){return new ce(this._messaging,this._language,this._platformPrefix,this._window,this._navigator,this._serviceWorkerLocation,this._token,this._currentChannels,this._currentDisabledChannels,this._currentOptions,this._credentials,this._logger)}}var ue,ge,pe,de,me,we,ke,fe,be,Ce,Se,Pe,Ae,Te,ve=s(349);class ye{constructor(e){this._storage=new ve.ObjectMapStorage(ve.IndexedDBStringMapStorageFactory.make(e))}getStorage(){return this._storage}}ue=document,ge=navigator,pe=window,de=cjs.Api.clientStorage,me=cjs.dic.get("util_trans"),we=cjs.Api.loader.get("notifications"),ke=cjs.Api.loader.get("notifications/gui"),fe=cjs.Api.loader.get("cjs"),be=cjs.Api.loader.get("myGames"),Ce=cjs.Api.loader.get("myTeams"),Se=cjs.Api.loader.get("loginClient"),Pe=cjs.dic.get("HighlightWindowManager"),Ae=()=>cjs.Api.config.get("app","google_analytics","event_tracking"),Te=window.dataLayer=window.dataLayer||[],fe.call(e=>{if(!cjs.dic.get("util_browser").isMobile()&&29!=cjs.Api.config.get("app","project","id")&&49!=cjs.Api.config.get("app","project","id"))return void we.fulfill(e=>{e(!1)});const t=cjs.Api.config.get("app","url_prefix")+"/x/js/worker.js",s=(new _e).setFirebaseConfiguration(cjs.Api.config.get("app","native_notifications","firebase")).setPlatformPrefix(cjs.Api.config.get("app","native_notifications","lsnp")).setLanguage(cjs.Api.config.get("app","lang","web")).setBrowserDepenedency(pe,ge).setServiceWorkerLocation(t).setTokenStorage(new ye("lsnp").getStorage()).setSettingsStorage(new ye("lsnp").getStorage()).setCredentialsStorage(new ye("lsnp").getStorage()).setLogger(e=>{clog("PushNotification",e)}).build();if("Notification"in pe){const e=document.getElementById("notifications-alert-wrapper"),t=s.getNotificationInit(),r=()=>{t.run().then(e=>{s.getStatusAlert().hideAlert(),e==n.INITIALIZED?(()=>{Ae()&&Te.push({event:"webNotificationStatus",webNotification:"on"});const e=ue.getElementById("userNotifications");e&&e.classList.add("userControls__item--open"),ke.call(t=>{t.enable(),e&&e.addEventListener("click",e=>{Pe.changeActive("verticalMenu",!1),t.getHandlerOnClick()(e)})}),s.enable();const t=()=>(s.getStatusAlert().showAlert(),s.synchronize());be.call(e=>{s.setMyGames(e),e.addChangeCallback(t),t()}),Ce.call(e=>{s.setMyTeams(e),e.registerCallback("add",t),e.registerCallback("remove",t),e.registerCallback("dataLoaded",t),t()}),Se.call(e=>{s.setLoginClient(e),e.registerCallback("login",t),e.registerCallback("logout",t),e.registerCallback("dataSyncChange/mygames",t),e.registerCallback("dataSyncChange/myTeams",t),t()}),we.fulfill(e=>{e(s)})})():Ae()&&Te.push({event:"webNotificationStatus",webNotification:"off"})}).catch(e=>{s.getStatusAlert().hideAlert()})},i=()=>{Ae()&&Te.push({event:"webNotificationStatus",webNotification:"off"});const e=()=>{s.getStatusAlert().showAlert();const e=ue.getElementById("notifications-alert");if(e){const t=e.querySelector(".alert__close");t&&t.addEventListener("click",()=>{de.storeSession("LS_notifications_dismissed",1,1209600)})}};be.call(t=>{s.setMyGames(t),t.addChangeCallback(e)}),Ce.call(t=>{s.setMyTeams(t),t.registerCallback("add",e),t.registerCallback("remove",e),t.registerCallback("dataLoaded",e)}),Se.call(t=>{s.setLoginClient(t),t.registerCallback("login",e),t.registerCallback("logout",e),t.registerCallback("dataSyncChange/mygames",e),t.registerCallback("dataSyncChange/myTeams",e)})},a=()=>{Ae()&&Te.push({event:"webNotificationStatus",webNotification:"disallow"});const e=ue.getElementById("notifications-alert");if(e){const t=e.querySelector(".alert__close");t&&t.addEventListener("click",()=>{de.storeSession("LS_notifications_dismissed",1,7776e3)})}const t=ue.getElementById("userNotifications");if(t){t.classList.add("userControls__item--open");const e=t.querySelector(".userControls__textNotifications");e&&e.classList.add("userControls__textNotifications--open")}};s.setPermissionProvider(()=>Notification.permission).setAlertWrapper(e).getStatusAlert().setStorage(de).setTranslations(me).setSubscribeCallback(r).setPendingCallback(i).setDeniedCallback(a).run()}})}},[[530,0,1]]]);